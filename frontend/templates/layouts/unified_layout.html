<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="{% block meta_description %}SustainaTrend™ Intelligence Platform - Advanced sustainability analytics and real-time trend monitoring{% endblock %}">
  
  <title>{% block title %}SustainaTrend™ Intelligence Platform{% endblock %}</title>
  
  <!-- Favicon -->
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Base Stylesheets -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/unified-theme.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/navigation-components.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/sustainatrend-framework.css') }}">
  
  <!-- Additional head content -->
  {% block head_extras %}{% endblock %}
</head>
<body>
  <div class="unified-page">
    <!-- Sidebar Navigation -->
    <aside class="unified-sidebar">
      <div class="unified-sidenav">
        <div class="unified-sidenav-category">
          <h3 class="unified-sidenav-title">Platform</h3>
          <ul class="unified-sidenav-items">
            <li class="unified-sidenav-item">
              <a href="/" class="unified-sidenav-link {% if request.path == '/' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                Home
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/dashboard" class="unified-sidenav-link {% if request.path == '/dashboard' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>
                Dashboard
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/search" class="unified-sidenav-link {% if request.path == '/search' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                Search
              </a>
            </li>
          </ul>
        </div>
        
        <div class="unified-sidenav-category">
          <h3 class="unified-sidenav-title">Sustainability</h3>
          <ul class="unified-sidenav-items">
            <li class="unified-sidenav-item">
              <a href="/trend-analysis-unified" class="unified-sidenav-link {% if '/trend-analysis' in request.path %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                Trend Analysis
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/sustainability-stories" class="unified-sidenav-link {% if request.path == '/sustainability-stories' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                Stories
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/realestate-minimal" class="unified-sidenav-link {% if '/realestate' in request.path %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                Real Estate
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/regulatory-ai/" class="unified-sidenav-link {% if '/regulatory-ai' in request.path %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>
                Regulatory AI Agent
              </a>
            </li>
          </ul>
        </div>
        
        <div class="unified-sidenav-category">
          <h3 class="unified-sidenav-title">Analytics</h3>
          <ul class="unified-sidenav-items">
            <li class="unified-sidenav-item">
              <a href="/analytics-dashboard" class="unified-sidenav-link {% if request.path == '/analytics-dashboard' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 0 0-6.88 17.28L12 13l6.88 6.28A10 10 0 1 0 12 2Z"/><circle cx="12" cy="13" r="2"/><path d="M12 19v-7"/></svg>
                Predictive Analytics
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/sentiment-analysis" class="unified-sidenav-link {% if request.path == '/sentiment-analysis' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></svg>
                Sentiment Analysis
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/monetization-opportunities" class="unified-sidenav-link {% if request.path == '/monetization-opportunities' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="8"/><line x1="3" x2="6" y1="3" y2="6"/><line x1="21" x2="18" y1="3" y2="6"/><line x1="3" x2="6" y1="21" y2="18"/><line x1="21" x2="18" y1="21" y2="18"/></svg>
                Monetization
              </a>
            </li>
          </ul>
        </div>
        
        <div class="unified-sidenav-category">
          <h3 class="unified-sidenav-title">Tools</h3>
          <ul class="unified-sidenav-items">
            <li class="unified-sidenav-item">
              <a href="/document-upload" class="unified-sidenav-link {% if request.path == '/document-upload' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M12 12v6"/><path d="M15 15l-3-3-3 3"/></svg>
                Document Upload
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/ethical-ai" class="unified-sidenav-link {% if request.path == '/ethical-ai' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
                Ethical AI
              </a>
            </li>
            <li class="unified-sidenav-item">
              <a href="/company-search" class="unified-sidenav-link {% if request.path == '/company-search' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></svg>
                Company Search
              </a>
            </li>
          </ul>
        </div>
      </div>
    </aside>
    
    <!-- Main Content -->
    <div class="unified-main">
      <!-- Header -->
      <header class="unified-header">
        <div class="unified-topnav">
          <div class="unified-logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c6.5-6 8-12 8-18H4c0 6 1.5 12 8 18Z"/><path d="M12 2v20"/><path d="M2 12h20"/><path d="M7 12a5 5 0 0 0 10 0"/></svg>
            <div class="unified-logo-text">Sustaina<span>Trend</span>™</div>
          </div>
          
          <div class="unified-nav-menu">
            <a href="/" class="unified-nav-item {% if request.path == '/' %}active{% endif %}">Home</a>
            <a href="/dashboard" class="unified-nav-item {% if request.path == '/dashboard' %}active{% endif %}">Dashboard</a>
            <a href="/trend-analysis-unified" class="unified-nav-item {% if '/trend-analysis' in request.path %}active{% endif %}">Trends</a>
            <a href="/sustainability-stories" class="unified-nav-item {% if request.path == '/sustainability-stories' %}active{% endif %}">Stories</a>
            <a href="/regulatory-ai/" class="unified-nav-item {% if '/regulatory-ai' in request.path %}active{% endif %}">Regulatory AI</a>
          </div>
          
          <div class="unified-nav-actions">
            <div class="unified-search-box">
              <svg class="unified-search-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
              <input type="text" class="unified-search-input" placeholder="Search sustainability data...">
            </div>
            
            <button class="unified-mobile-nav-toggle">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
            </button>
            
            <a href="/unified-ai-prompt" class="unified-nav-button">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 0 0-6.88 17.28L12 13l6.88 6.28A10 10 0 1 0 12 2Z"/><circle cx="12" cy="13" r="2"/><path d="M12 19v-7"/></svg>
              Ask AI
            </a>
            
            <div class="unified-user-avatar">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            </div>
          </div>
        </div>
      </header>
      
      <!-- Page Header -->
      <div class="unified-header-content">
        {% block header_title %}
        <h1>SustainaTrend™ Intelligence Platform</h1>
        <p class="unified-subtitle">Advanced sustainability analytics and real-time trend monitoring</p>
        {% endblock %}
      </div>
      
      <!-- Page Content -->
      {% block main_content %}
      <main class="unified-main-container">
        <p>Default content - this should be overridden by templates that extend this layout.</p>
      </main>
      {% endblock %}
      
      <!-- AI Prompt Bar -->
      <div class="unified-ai-prompt-container">
        <div class="unified-ai-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 0 0-6.88 17.28L12 13l6.88 6.28A10 10 0 1 0 12 2Z"/><circle cx="12" cy="13" r="2"/><path d="M12 19v-7"/></svg>
        </div>
        <div class="unified-ai-input">
          <input type="text" class="unified-ai-prompt" id="aiPrompt" placeholder="Ask SustainaTrend AI about sustainability trends, metrics, or insights...">
          <button class="unified-ai-submit" id="aiSubmit">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Mobile Navigation -->
  <div class="unified-mobile-nav">
    <div class="unified-sidenav">
      <div class="unified-sidenav-category">
        <h3 class="unified-sidenav-title">Platform</h3>
        <ul class="unified-sidenav-items">
          <li class="unified-sidenav-item">
            <a href="/" class="unified-sidenav-link {% if request.path == '/' %}active{% endif %}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
              Home
            </a>
          </li>
          <li class="unified-sidenav-item">
            <a href="/dashboard" class="unified-sidenav-link {% if request.path == '/dashboard' %}active{% endif %}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>
              Dashboard
            </a>
          </li>
          <li class="unified-sidenav-item">
            <a href="/search" class="unified-sidenav-link {% if request.path == '/search' %}active{% endif %}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
              Search
            </a>
          </li>
        </ul>
      </div>
      
      <!-- Additional mobile menu items - simplified version of sidebar -->
      <div class="unified-sidenav-category">
        <h3 class="unified-sidenav-title">Features</h3>
        <ul class="unified-sidenav-items">
          <li class="unified-sidenav-item">
            <a href="/trend-analysis-unified" class="unified-sidenav-link {% if '/trend-analysis' in request.path %}active{% endif %}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
              Trend Analysis
            </a>
          </li>
          <li class="unified-sidenav-item">
            <a href="/sustainability-stories" class="unified-sidenav-link {% if request.path == '/sustainability-stories' %}active{% endif %}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
              Stories
            </a>
          </li>
          <li class="unified-sidenav-item">
            <a href="/realestate-minimal" class="unified-sidenav-link {% if '/realestate' in request.path %}active{% endif %}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
              Real Estate
            </a>
          </li>
          <li class="unified-sidenav-item">
            <a href="/analytics-dashboard" class="unified-sidenav-link {% if request.path == '/analytics-dashboard' %}active{% endif %}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 0 0-6.88 17.28L12 13l6.88 6.28A10 10 0 1 0 12 2Z"/><circle cx="12" cy="13" r="2"/><path d="M12 19v-7"/></svg>
              Analytics
            </a>
          </li>
          <li class="unified-sidenav-item">
            <a href="/regulatory-ai/" class="unified-sidenav-link {% if '/regulatory-ai' in request.path %}active{% endif %}">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>
              Regulatory AI
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  
  <!-- Basic JavaScript for components -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Mobile Navigation Toggle
      const mobileNavToggle = document.querySelector('.unified-mobile-nav-toggle');
      const mobileNav = document.querySelector('.unified-mobile-nav');
      
      if (mobileNavToggle && mobileNav) {
        mobileNavToggle.addEventListener('click', function() {
          mobileNav.classList.toggle('active');
        });
      }
      
      // AI Prompt Submission
      const aiPrompt = document.getElementById('aiPrompt');
      const aiSubmit = document.getElementById('aiSubmit');
      
      if (aiPrompt && aiSubmit) {
        aiSubmit.addEventListener('click', function() {
          submitAiPrompt();
        });
        
        aiPrompt.addEventListener('keydown', function(e) {
          if (e.key === 'Enter') {
            submitAiPrompt();
          }
        });
      }
      
      function submitAiPrompt() {
        const prompt = aiPrompt.value.trim();
        if (prompt) {
          // Show loading state
          aiSubmit.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>';
          aiSubmit.disabled = true;
          
          // Submit prompt to API
          fetch('/api/ai-prompt', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ prompt: prompt })
          })
          .then(response => response.json())
          .then(data => {
            // Reset input and button
            aiPrompt.value = '';
            aiSubmit.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>';
            aiSubmit.disabled = false;
            
            // Handle redirect if provided
            if (data.redirect) {
              window.location.href = data.redirect;
            } else if (data.insight) {
              // Display AI insight
              alert(data.insight);
            }
          })
          .catch(error => {
            console.error('Error submitting AI prompt:', error);
            aiSubmit.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>';
            aiSubmit.disabled = false;
          });
        }
      }
    });
  </script>
  
  <!-- Additional scripts -->
  {% block scripts %}{% endblock %}
  
  <!-- Base Co-Pilot scripts -->
  <script type="module" src="{{ url_for('static', filename='js/copilot-prompt-templates.js') }}"></script>
  <script src="{{ url_for('static', filename='js/sustainability-copilot.js') }}"></script>
</body>
</html>