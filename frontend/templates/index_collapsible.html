{% extends "layouts/collapsible_layout.html" %}

{% block title %}SustainaTrend™ Intelligence Platform{% endblock %}

{% block header_title %}Sustainability Intelligence Platform{% endblock %}

{% block header_actions %}
    <button class="btn-primary" id="toggle-copilot-button" onclick="window.copilotInstance.toggleCopilot()">
        <span class="material-icons">smart_toy</span>
        Open Co-Pilot
    </button>
{% endblock %}

{% block additional_css %}
<style>
    /* KPI Cards */
    .st-kpi-card {
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.08);
        padding: 20px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .st-kpi-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.12);
    }
    
    .st-kpi-icon {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 15px;
        flex-shrink: 0;
    }
    
    .st-kpi-icon .material-icons {
        font-size: 28px;
        color: white;
    }
    
    .st-kpi-icon.energy {
        background: linear-gradient(135deg, #FF9800, #F57C00);
    }
    
    .st-kpi-icon.emissions {
        background: linear-gradient(135deg, #4CAF50, #2E7D32);
    }
    
    .st-kpi-icon.water {
        background: linear-gradient(135deg, #2196F3, #1976D2);
    }
    
    .st-kpi-content {
        flex-grow: 1;
    }
    
    .st-kpi-content h4 {
        margin: 0 0 5px 0;
        font-size: 14px;
        color: #666;
    }
    
    .st-kpi-value {
        font-size: 26px;
        font-weight: 700;
        color: #333;
        margin-bottom: 5px;
    }
    
    .st-kpi-unit {
        font-size: 16px;
        color: #666;
        margin-left: 2px;
    }
    
    .st-kpi-trend {
        display: flex;
        align-items: center;
        font-size: 14px;
        font-weight: 500;
    }
    
    .st-kpi-trend.positive {
        color: #4CAF50;
    }
    
    .st-kpi-trend.negative {
        color: #F44336;
    }
    
    .st-kpi-trend .material-icons {
        font-size: 16px;
        margin-right: 3px;
    }
    
    /* AI Insight Card */
    .st-ai-insight-card {
        background-color: #F5F5F5;
        border-radius: 8px;
        border-left: 4px solid #9C27B0;
        padding: 20px;
    }
    
    .st-ai-insight-header {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .st-ai-insight-header .material-icons {
        color: #9C27B0;
        margin-right: 10px;
        font-size: 22px;
    }
    
    .st-ai-insight-header h4 {
        margin: 0;
        font-size: 16px;
        color: #555;
    }
    
    .st-ai-insight-content {
        margin-bottom: 15px;
    }
    
    .st-ai-insight-content p {
        color: #333;
        line-height: 1.5;
        margin: 0;
    }
    
    .st-ai-insight-footer {
        display: flex;
        justify-content: flex-end;
    }
    
    /* Quick Navigation Grid */
    .st-quick-nav-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
    }
    
    .st-quick-nav-item {
        background-color: #fff;
        border-radius: 8px;
        padding: 15px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        color: #333;
        text-decoration: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: all 0.2s ease;
    }
    
    .st-quick-nav-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
        color: #2E7D32;
    }
    
    .st-quick-nav-item .material-icons {
        font-size: 28px;
        margin-bottom: 8px;
        color: #2E7D32;
    }
    
    /* Quick Prompts */
    .st-quick-prompts {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    
    .st-quick-prompt-btn {
        background-color: #E8F5E9;
        border: 1px solid #C8E6C9;
        border-radius: 20px;
        padding: 10px 15px;
        color: #2E7D32;
        font-size: 14px;
        text-align: left;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .st-quick-prompt-btn:hover {
        background-color: #C8E6C9;
        transform: translateX(5px);
    }
    
    /* Welcome Banner */
    .welcome-banner {
        background: linear-gradient(135deg, rgba(46, 125, 50, 0.9), rgba(27, 94, 32, 0.9));
        border-radius: 8px;
        padding: 25px;
        color: white;
        margin-bottom: 30px;
    }
    
    /* Utility Classes */
    .mt-3 {
        margin-top: 15px;
    }
    
    .mt-4 {
        margin-top: 20px;
    }
    
    /* Responsive Adjustments */
    @media (max-width: 768px) {
        .st-quick-nav-grid {
            grid-template-columns: 1fr;
        }
        
        .row {
            display: flex;
            flex-direction: column;
        }
        
        .col-md-4 {
            width: 100%;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="st-content-area">
    <div class="st-content-header">
        <div class="st-content-header-info">
            <h1 class="st-content-title">SustainaTrend™ Intelligence Platform</h1>
            <p class="st-content-description">Transforming complex sustainability data into actionable insights</p>
        </div>
    </div>

    <!-- AI Co-Pilot Card - Now more prominent -->
    <div class="st-data-card">
        <div class="st-data-card-header">
            <h3 class="st-data-card-title">
                <span class="material-icons">smart_toy</span> 
                AI Co-Pilot Assistant
            </h3>
            <button class="st-data-toggle">
                <span class="material-icons">expand_more</span>
            </button>
        </div>
        <div class="st-data-content">
            <div class="welcome-banner">
                <h3>Welcome to SustainaTrend™ 2025!</h3>
                <p>What do you need to know today? Our AI Co-Pilot is ready to help you discover insights, analyze data, and make informed sustainability decisions.</p>
                
                <button class="st-btn-primary mt-3" onclick="window.copilotInstance.toggleCopilot()">
                    <span class="material-icons">smart_toy</span> Ask the Co-Pilot
                </button>
            </div>
            
            <div class="mb-4">
                <h4>Quick Questions to Get Started:</h4>
                <div class="st-quick-prompts">
                    <button class="st-quick-prompt-btn" onclick="window.copilotInstance.usePrompt('What are my top sustainability KPIs today?')">
                        What are my top sustainability KPIs today?
                    </button>
                    <button class="st-quick-prompt-btn" onclick="window.copilotInstance.usePrompt('Generate a sustainability summary for this week')">
                        Generate a sustainability summary for this week
                    </button>
                    <button class="st-quick-prompt-btn" onclick="window.copilotInstance.usePrompt('What sustainability trends should I be aware of?')">
                        What sustainability trends should I be aware of?
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Executive KPI Summary - New focused section -->
    <div class="st-data-card">
        <div class="st-data-card-header">
            <h3 class="st-data-card-title">
                <span class="material-icons">insights</span>
                Executive KPI Summary
            </h3>
            <button class="st-data-toggle">
                <span class="material-icons">expand_more</span>
            </button>
        </div>
        <div class="st-data-content">
            <div class="row">
                <!-- Energy KPI -->
                <div class="col-md-4">
                    <div class="st-kpi-card">
                        <div class="st-kpi-icon energy">
                            <span class="material-icons">bolt</span>
                        </div>
                        <div class="st-kpi-content">
                            <h4>Energy Efficiency</h4>
                            <div class="st-kpi-value">78.4<span class="st-kpi-unit">%</span></div>
                            <div class="st-kpi-trend positive">
                                <span class="material-icons">trending_up</span> 5.2%
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Emissions KPI -->
                <div class="col-md-4">
                    <div class="st-kpi-card">
                        <div class="st-kpi-icon emissions">
                            <span class="material-icons">cloud</span>
                        </div>
                        <div class="st-kpi-content">
                            <h4>Carbon Emissions</h4>
                            <div class="st-kpi-value">24.7<span class="st-kpi-unit">t</span></div>
                            <div class="st-kpi-trend negative">
                                <span class="material-icons">trending_down</span> 12.3%
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Water KPI -->
                <div class="col-md-4">
                    <div class="st-kpi-card">
                        <div class="st-kpi-icon water">
                            <span class="material-icons">water_drop</span>
                        </div>
                        <div class="st-kpi-content">
                            <h4>Water Usage</h4>
                            <div class="st-kpi-value">3.2<span class="st-kpi-unit">kL</span></div>
                            <div class="st-kpi-trend negative">
                                <span class="material-icons">trending_down</span> 8.5%
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- AI-Generated Insight -->
            <div class="st-ai-insight-card mt-4">
                <div class="st-ai-insight-header">
                    <span class="material-icons">psychology</span>
                    <h4>AI-Generated Insight</h4>
                </div>
                <div class="st-ai-insight-content">
                    <p>Your emissions reduction initiatives are showing strong results with a 12.3% decrease in carbon emissions. Energy efficiency improvements continue to trend positively, but water usage has slightly increased compared to last month. Consider reviewing your water conservation practices.</p>
                </div>
                <div class="st-ai-insight-footer">
                    <button class="st-btn-outline-secondary" onclick="window.copilotInstance.usePrompt('Give me more detailed insights on our sustainability KPIs')">
                        <span class="material-icons">auto_awesome</span> Get Deeper Insights
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- One-Click Navigation -->
    <div class="st-data-card">
        <div class="st-data-card-header">
            <h3 class="st-data-card-title">Quick Navigation</h3>
            <button class="st-data-toggle">
                <span class="material-icons">expand_more</span>
            </button>
        </div>
        <div class="st-data-content">
            <div class="st-quick-nav-grid">
                <a href="/analytics-dashboard" class="st-quick-nav-item">
                    <span class="material-icons">dashboard</span>
                    <span>Analytics Dashboard</span>
                </a>
                <a href="/sustainability-stories" class="st-quick-nav-item">
                    <span class="material-icons">auto_stories</span>
                    <span>Stories</span>
                </a>
                <a href="/document-upload" class="st-quick-nav-item">
                    <span class="material-icons">upload_file</span>
                    <span>Document Processing</span>
                </a>
                <a href="/trend-analysis" class="st-quick-nav-item">
                    <span class="material-icons">trending_up</span>
                    <span>Trend Analysis</span>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/sustainability-copilot.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize the Co-Pilot with home page context
        if (typeof initSustainabilityCopilot === 'function') {
            initSustainabilityCopilot({
                context: 'home',
                suggestedPrompts: [
                    "What features does the platform offer?",
                    "How can I analyze sustainability trends?",
                    "Show me the latest sustainability metrics",
                    "Generate a sustainability report for my company"
                ]
            });
        }
    });
</script>
{% endblock %}