{% extends "layouts/finchat_dark_layout.html" %}

{% block title %}Company Overview | SustainaTrendâ„¢ Platform{% endblock %}

{% block header_title %}Company Overview{% endblock %}

{% block additional_styles %}
<style>
    .overview-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--fc-spacing-lg);
    }
    
    .overview-card {
        background-color: var(--fc-bg-card);
        border-radius: var(--fc-radius);
        padding: var(--fc-spacing-lg);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .overview-full-width {
        grid-column: 1 / -1;
    }
    
    .overview-company-info {
        display: flex;
        flex-direction: column;
        gap: var(--fc-spacing-md);
    }
    
    .overview-company-name {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--fc-text-primary);
    }
    
    .overview-info-row {
        display: flex;
        justify-content: space-between;
        padding: var(--fc-spacing-sm) 0;
        border-bottom: 1px solid var(--fc-border);
    }
    
    .overview-info-row:last-child {
        border-bottom: none;
    }
    
    .overview-info-label {
        color: var(--fc-text-secondary);
    }
    
    .overview-info-value {
        color: var(--fc-text-primary);
        font-weight: 500;
    }
    
    .overview-rating-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: var(--fc-spacing-md);
        margin-top: var(--fc-spacing-md);
    }
    
    .overview-rating-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
    }
    
    .overview-rating-value {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--fc-primary);
        margin-bottom: var(--fc-spacing-xs);
    }
    
    .overview-rating-label {
        font-size: 0.9rem;
        color: var(--fc-text-secondary);
    }
    
    .initiative-item {
        display: flex;
        flex-direction: column;
        gap: var(--fc-spacing-xs);
        padding: var(--fc-spacing-md) 0;
        border-bottom: 1px solid var(--fc-border);
    }
    
    .initiative-item:last-child {
        border-bottom: none;
    }
    
    .initiative-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .initiative-title {
        font-weight: 600;
        color: var(--fc-text-primary);
    }
    
    .initiative-status {
        font-size: 0.8rem;
        padding: 2px 8px;
        border-radius: 10px;
        background-color: var(--fc-bg-tertiary);
    }
    
    .status-progress {
        background-color: var(--fc-positive-light);
        color: var(--fc-positive);
    }
    
    .status-planning {
        background-color: var(--fc-warning-light);
        color: var(--fc-warning);
    }
    
    .overview-progress {
        width: 100%;
        height: 6px;
        background-color: var(--fc-bg-tertiary);
        border-radius: 3px;
        margin-top: var(--fc-spacing-xs);
    }
    
    .overview-progress-bar {
        height: 100%;
        border-radius: 3px;
        background-color: var(--fc-primary);
    }
    
    @media (max-width: 768px) {
        .overview-container {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block main_content %}
<div class="finchat-content-wrapper">
    <div class="finchat-content-header">
        <h1>Company Overview</h1>
        <p class="text-secondary">Comprehensive sustainability profile and performance</p>
    </div>
    
    <div class="overview-container" id="overviewContainer">
        <!-- Overview content will be loaded here -->
        <div class="finchat-loader">
            <div class="finchat-spinner"></div>
            <div>Loading overview data...</div>
        </div>
    </div>
</div>
{% endblock %}

{% block additional_scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Fetch overview data
        fetch('/overview/api/summary')
            .then(response => response.json())
            .then(data => {
                const container = document.getElementById('overviewContainer');
                
                // Create HTML structure with data
                container.innerHTML = `
                    <div class="overview-card">
                        <h2>Company Profile</h2>
                        <div class="overview-company-info">
                            <div class="overview-company-name">${data.company.name}</div>
                            
                            <div class="overview-info-row">
                                <div class="overview-info-label">Industry</div>
                                <div class="overview-info-value">${data.company.industry}</div>
                            </div>
                            
                            <div class="overview-info-row">
                                <div class="overview-info-label">Founded</div>
                                <div class="overview-info-value">${data.company.founded}</div>
                            </div>
                            
                            <div class="overview-info-row">
                                <div class="overview-info-label">Employees</div>
                                <div class="overview-info-value">${data.company.employees.toLocaleString()}</div>
                            </div>
                            
                            <div class="overview-info-row">
                                <div class="overview-info-label">Locations</div>
                                <div class="overview-info-value">${data.company.locations.join(', ')}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="overview-card">
                        <h2>Sustainability Performance</h2>
                        <div class="overview-info-row">
                            <div class="overview-info-label">ESG Rating</div>
                            <div class="overview-info-value">${data.sustainability_summary.esg_rating}</div>
                        </div>
                        
                        <div class="overview-rating-grid">
                            <div class="overview-rating-item">
                                <div class="overview-rating-value">${data.sustainability_summary.emission_reduction}</div>
                                <div class="overview-rating-label">Emission Reduction</div>
                            </div>
                            
                            <div class="overview-rating-item">
                                <div class="overview-rating-value">${data.sustainability_summary.renewable_energy}</div>
                                <div class="overview-rating-label">Renewable Energy</div>
                            </div>
                            
                            <div class="overview-rating-item">
                                <div class="overview-rating-value">${data.sustainability_summary.waste_reduction}</div>
                                <div class="overview-rating-label">Waste Reduction</div>
                            </div>
                            
                            <div class="overview-rating-item">
                                <div class="overview-rating-value">${data.sustainability_summary.water_conservation}</div>
                                <div class="overview-rating-label">Water Conservation</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="overview-card overview-full-width">
                        <h2>Key Initiatives</h2>
                        <div class="initiatives-list">
                            ${data.key_initiatives.map(initiative => `
                                <div class="initiative-item">
                                    <div class="initiative-header">
                                        <div class="initiative-title">${initiative.name}</div>
                                        <div class="initiative-status status-${initiative.status.toLowerCase().replace(' ', '')}">${initiative.status}</div>
                                    </div>
                                    <div class="overview-progress">
                                        <div class="overview-progress-bar" style="width: ${initiative.completion}%"></div>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--fc-text-secondary); margin-top: 4px;">
                                        <div>Progress</div>
                                        <div>${initiative.completion}%</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            })
            .catch(error => {
                console.error('Error fetching overview data:', error);
                const container = document.getElementById('overviewContainer');
                container.innerHTML = '<div class="finchat-alert finchat-alert-error">Failed to load overview data. Please try again later.</div>';
            });
    });
</script>
{% endblock %}