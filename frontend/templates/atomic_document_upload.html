{% extends "layouts/atomic_layout.html" %}

{% block title %}Document Analysis | SustainaTrendâ„¢{% endblock %}

{% block meta_description %}Upload and analyze sustainability reports and ESG documents with AI-powered insights and framework alignment.{% endblock %}

{% block head_extras %}
<style>
  .st-upload-container {
    background-color: var(--st-surface);
    border: 2px dashed var(--st-border-color);
    border-radius: 0.625rem;
    padding: 2.5rem;
    text-align: center;
    transition: all 0.2s ease;
  }
  
  .st-upload-container:hover,
  .st-upload-container.st-drag-active {
    border-color: var(--st-primary);
    background-color: var(--st-primary-light);
  }
  
  .st-upload-icon {
    font-size: 3rem;
    color: var(--st-primary);
    margin-bottom: 1rem;
  }
  
  .st-upload-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }
  
  .st-upload-subtitle {
    color: var(--st-text-secondary);
    margin-bottom: 1.5rem;
  }
  
  .st-upload-form {
    margin-top: 1.5rem;
  }
  
  .st-file-input {
    display: none;
  }
  
  .st-document-preview {
    background-color: var(--st-surface);
    border-radius: 0.5rem;
    padding: 1.25rem;
    margin-top: 1.5rem;
    border: 1px solid var(--st-border-color);
    display: none;
    max-height: 18.75rem;
    overflow-y: auto;
  }
  
  .st-document-preview__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
  }
  
  .st-document-preview__title {
    font-weight: 600;
    font-size: 1rem;
  }
  
  .st-document-preview__close {
    background: none;
    border: none;
    color: var(--st-text-secondary);
    cursor: pointer;
  }
  
  .st-document-preview__content {
    font-size: 0.875rem;
    line-height: 1.5;
  }
  
  .st-recent-document {
    padding: 1rem;
    border-radius: 0.5rem;
    background-color: var(--st-surface);
    margin-bottom: 0.75rem;
    border: 1px solid var(--st-border-color);
    transition: all 0.2s ease;
  }
  
  .st-recent-document:hover {
    border-color: var(--st-primary);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  }
  
  .st-recent-document__header {
    display: flex;
    align-items: center;
    margin-bottom: 0.5rem;
  }
  
  .st-recent-document__icon {
    color: var(--st-primary);
    margin-right: 0.75rem;
  }
  
  .st-recent-document__title {
    font-weight: 600;
    font-size: 0.9375rem;
  }
  
  .st-recent-document__meta {
    display: flex;
    font-size: 0.75rem;
    color: var(--st-text-secondary);
  }
  
  .st-recent-document__date {
    margin-right: 1rem;
  }
  
  .st-framework-tag {
    display: inline-block;
    font-size: 0.75rem;
    padding: 0.125rem 0.5rem;
    border-radius: 1rem;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    background-color: var(--st-primary-light);
    color: var(--st-primary);
  }
  
  .st-analysis-step {
    display: flex;
    margin-bottom: 1.5rem;
  }
  
  .st-analysis-step__number {
    width: 2rem;
    height: 2rem;
    border-radius: 50%;
    background-color: var(--st-primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    margin-right: 1rem;
    flex-shrink: 0;
  }
  
  .st-analysis-step__content {
    flex: 1;
  }
  
  .st-analysis-step__title {
    font-weight: 600;
    margin-bottom: 0.25rem;
  }
  
  .st-analysis-step__description {
    color: var(--st-text-secondary);
    font-size: 0.875rem;
  }
  
  .st-file-list {
    margin-top: 1rem;
  }
  
  .st-file-item {
    display: flex;
    align-items: center;
    padding: 0.75rem;
    background-color: var(--st-surface);
    border-radius: 0.375rem;
    margin-bottom: 0.5rem;
    border: 1px solid var(--st-border-color);
  }
  
  .st-file-item__icon {
    margin-right: 0.75rem;
    color: var(--st-primary);
  }
  
  .st-file-item__name {
    flex: 1;
    font-size: 0.875rem;
    font-weight: 500;
  }
  
  .st-file-item__size {
    font-size: 0.75rem;
    color: var(--st-text-secondary);
    margin-right: 1rem;
  }
  
  .st-file-item__remove {
    background: none;
    border: none;
    color: var(--st-error);
    cursor: pointer;
    font-size: 0.875rem;
  }
  
  .st-analysis-result {
    display: none;
  }
</style>
{% endblock %}

{% block left_column %}
<div class="st-card">
  <div class="st-card__header">
    <h2 class="st-card__title">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><rect x="7" y="7" width="3" height="3"/><rect x="14" y="7" width="3" height="3"/><rect x="7" y="14" width="3" height="3"/><rect x="14" y="14" width="3" height="3"/></svg>
      Document Options
    </h2>
  </div>
  <div class="st-card__body">
    <div class="st-form-group">
      <label class="st-form-label">Analysis Type</label>
      <select class="st-select st-w-100">
        <option selected>Comprehensive Analysis</option>
        <option>ESRS Compliance Check</option>
        <option>Materiality Assessment</option>
        <option>Carbon Footprint Focus</option>
        <option>ESG Disclosure Check</option>
      </select>
    </div>
    
    <div class="st-form-group">
      <label class="st-form-label">Frameworks to Check</label>
      <div class="st-checkbox-group">
        <label class="st-checkbox">
          <input type="checkbox" checked> ESRS
        </label>
        <label class="st-checkbox">
          <input type="checkbox" checked> GRI
        </label>
        <label class="st-checkbox">
          <input type="checkbox" checked> TCFD
        </label>
        <label class="st-checkbox">
          <input type="checkbox" checked> SASB
        </label>
        <label class="st-checkbox">
          <input type="checkbox"> CSRD
        </label>
        <label class="st-checkbox">
          <input type="checkbox"> SFDR
        </label>
      </div>
    </div>
    
    <div class="st-form-group">
      <label class="st-form-label">Processing Options</label>
      <div class="st-checkbox-group">
        <label class="st-checkbox">
          <input type="checkbox" checked> Use OCR for scanned documents
        </label>
        <label class="st-checkbox">
          <input type="checkbox" checked> Extract numerical KPIs
        </label>
        <label class="st-checkbox">
          <input type="checkbox" checked> Generate executive summary
        </label>
        <label class="st-checkbox">
          <input type="checkbox" checked> Perform gap analysis
        </label>
      </div>
    </div>
    
    <div class="st-form-group">
      <label class="st-form-label">AI Model</label>
      <select class="st-select st-w-100">
        <option selected>GPT-4 Turbo</option>
        <option>Claude 3</option>
        <option>Gemini Pro</option>
        <option>Standard (Faster)</option>
      </select>
    </div>
    
    <button class="st-button st-button--outline st-w-100 st-mt-4">Analyze Document</button>
  </div>
</div>

<div class="st-card">
  <div class="st-card__header">
    <h2 class="st-card__title">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
      Recent Documents
    </h2>
  </div>
  <div class="st-card__body">
    <div class="st-recent-documents">
      <a href="#" class="st-recent-document">
        <div class="st-recent-document__header">
          <div class="st-recent-document__icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
          </div>
          <div class="st-recent-document__title">Annual Sustainability Report 2024</div>
        </div>
        <div class="st-recent-document__meta">
          <div class="st-recent-document__date">Uploaded 2 days ago</div>
          <div class="st-recent-document__size">4.2 MB</div>
        </div>
        <div class="st-recent-document__frameworks">
          <span class="st-framework-tag">GRI</span>
          <span class="st-framework-tag">TCFD</span>
          <span class="st-framework-tag">ESRS</span>
        </div>
      </a>
      
      <a href="#" class="st-recent-document">
        <div class="st-recent-document__header">
          <div class="st-recent-document__icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
          </div>
          <div class="st-recent-document__title">ESG Disclosure Statement</div>
        </div>
        <div class="st-recent-document__meta">
          <div class="st-recent-document__date">Uploaded last week</div>
          <div class="st-recent-document__size">2.7 MB</div>
        </div>
        <div class="st-recent-document__frameworks">
          <span class="st-framework-tag">SASB</span>
          <span class="st-framework-tag">ESRS</span>
        </div>
      </a>
      
      <a href="#" class="st-recent-document">
        <div class="st-recent-document__header">
          <div class="st-recent-document__icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
          </div>
          <div class="st-recent-document__title">Carbon Neutral Strategy</div>
        </div>
        <div class="st-recent-document__meta">
          <div class="st-recent-document__date">Uploaded 3 weeks ago</div>
          <div class="st-recent-document__size">1.5 MB</div>
        </div>
        <div class="st-recent-document__frameworks">
          <span class="st-framework-tag">TCFD</span>
        </div>
      </a>
    </div>
  </div>
</div>
{% endblock %}

{% block center_column %}
<div class="st-card">
  <div class="st-card__header">
    <h2 class="st-card__title">Document Analysis</h2>
  </div>
  <div class="st-card__body">
    <p class="st-mb-4">Upload your sustainability reports, ESG disclosures, or environmental policies for comprehensive analysis, framework compliance checks, and AI-powered insights.</p>
    
    <div class="st-upload-container" id="upload-area">
      <div class="st-upload-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/></svg>
      </div>
      <h3 class="st-upload-title">Drag and drop your document here</h3>
      <p class="st-upload-subtitle">or click to browse files</p>
      
      <div class="st-upload-form">
        <input type="file" id="file-input" class="st-file-input" accept=".pdf,.doc,.docx,.xls,.xlsx,.csv,.txt" multiple />
        <button class="st-button st-button--outline" id="browse-button">Browse Files</button>
      </div>
      
      <p class="st-mt-3 st-text-secondary">Supported formats: PDF, DOC, DOCX, XLS, XLSX, CSV, TXT</p>
    </div>
    
    <div class="st-file-list" id="file-list"></div>
    
    <div class="st-document-preview" id="document-preview">
      <div class="st-document-preview__header">
        <div class="st-document-preview__title">Document Preview</div>
        <button class="st-document-preview__close" id="close-preview">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="st-document-preview__content" id="preview-content"></div>
    </div>
  </div>
</div>

<div class="st-card st-mt-4">
  <div class="st-card__header">
    <h2 class="st-card__title">Analysis Process</h2>
  </div>
  <div class="st-card__body">
    <div class="st-analysis-steps">
      <div class="st-analysis-step">
        <div class="st-analysis-step__number">1</div>
        <div class="st-analysis-step__content">
          <h3 class="st-analysis-step__title">Document Upload</h3>
          <p class="st-analysis-step__description">Upload your sustainability reports, ESG disclosures, and policy documents.</p>
        </div>
      </div>
      
      <div class="st-analysis-step">
        <div class="st-analysis-step__number">2</div>
        <div class="st-analysis-step__content">
          <h3 class="st-analysis-step__title">Text Extraction</h3>
          <p class="st-analysis-step__description">Our system extracts and processes text from your documents, including OCR for scanned pages.</p>
        </div>
      </div>
      
      <div class="st-analysis-step">
        <div class="st-analysis-step__number">3</div>
        <div class="st-analysis-step__content">
          <h3 class="st-analysis-step__title">AI Analysis</h3>
          <p class="st-analysis-step__description">Advanced AI analyzes your documents for sustainability metrics, frameworks alignment, and disclosure quality.</p>
        </div>
      </div>
      
      <div class="st-analysis-step">
        <div class="st-analysis-step__number">4</div>
        <div class="st-analysis-step__content">
          <h3 class="st-analysis-step__title">Framework Matching</h3>
          <p class="st-analysis-step__description">Documents are matched against leading frameworks like ESRS, GRI, SASB, and TCFD.</p>
        </div>
      </div>
      
      <div class="st-analysis-step">
        <div class="st-analysis-step__number">5</div>
        <div class="st-analysis-step__content">
          <h3 class="st-analysis-step__title">Gap Analysis</h3>
          <p class="st-analysis-step__description">Receive detailed gap analysis with recommendations for improving your disclosures.</p>
        </div>
      </div>
      
      <div class="st-analysis-step">
        <div class="st-analysis-step__number">6</div>
        <div class="st-analysis-step__content">
          <h3 class="st-analysis-step__title">Interactive Results</h3>
          <p class="st-analysis-step__description">View and interact with analysis results, including the option to export as reports.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="st-analysis-result" id="analysis-result">
  <!-- This section would be populated with analysis results -->
</div>
{% endblock %}

{% block right_column %}
<div class="st-card">
  <div class="st-card__header">
    <h2 class="st-card__title">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>
      About Document Analysis
    </h2>
  </div>
  <div class="st-card__body">
    <p>The SustainaTrendâ„¢ Document Analysis tool uses advanced AI to analyze your sustainability reports and ESG disclosures. Our system:</p>
    
    <ul class="st-list st-list--check st-mt-3">
      <li>Extracts key sustainability metrics and KPIs</li>
      <li>Checks alignment with major reporting frameworks</li>
      <li>Identifies disclosure gaps and improvement areas</li>
      <li>Generates executive summaries and visualizations</li>
      <li>Enables interactive exploration of your data</li>
    </ul>
    
    <p class="st-mt-3">The analysis results can be used to improve your sustainability reporting, ensure compliance with frameworks, and identify areas for strategic improvement.</p>
    
    <button class="st-button st-button--outline st-w-100 st-mt-3">Learn More</button>
  </div>
</div>

<div class="st-card">
  <div class="st-card__header">
    <h2 class="st-card__title">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
      Supported Frameworks
    </h2>
  </div>
  <div class="st-card__body">
    <div class="st-framework-item">
      <div class="st-framework-item__title">ESRS (European Sustainability Reporting Standards)</div>
      <div class="st-framework-item__description">The EU's comprehensive sustainability reporting framework covering environmental, social, and governance topics.</div>
    </div>
    
    <div class="st-framework-item">
      <div class="st-framework-item__title">GRI (Global Reporting Initiative)</div>
      <div class="st-framework-item__description">The world's most widely used sustainability reporting standards.</div>
    </div>
    
    <div class="st-framework-item">
      <div class="st-framework-item__title">TCFD (Task Force on Climate-related Financial Disclosures)</div>
      <div class="st-framework-item__description">Framework for climate-related financial risk disclosures.</div>
    </div>
    
    <div class="st-framework-item">
      <div class="st-framework-item__title">SASB (Sustainability Accounting Standards Board)</div>
      <div class="st-framework-item__description">Industry-specific standards for financial material sustainability topics.</div>
    </div>
    
    <div class="st-framework-item">
      <div class="st-framework-item__title">CSRD (Corporate Sustainability Reporting Directive)</div>
      <div class="st-framework-item__description">The EU directive that mandates sustainability reporting for certain companies.</div>
    </div>
    
    <div class="st-framework-item">
      <div class="st-framework-item__title">SFDR (Sustainable Finance Disclosure Regulation)</div>
      <div class="st-framework-item__description">EU regulation for sustainability-related disclosures in the financial services sector.</div>
    </div>
  </div>
</div>

<div class="st-card">
  <div class="st-card__header">
    <h2 class="st-card__title">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
      RAG Queries
    </h2>
  </div>
  <div class="st-card__body">
    <p>After uploading your document, you can ask specific questions about its content using our RAG (Retrieval-Augmented Generation) system.</p>
    
    <div class="st-sample-queries">
      <div class="st-sample-query">What are the main carbon reduction targets mentioned in this report?</div>
      <div class="st-sample-query">How does this document address biodiversity impacts?</div>
      <div class="st-sample-query">What water conservation metrics are tracked in this report?</div>
      <div class="st-sample-query">How does this report align with TCFD recommendations?</div>
      <div class="st-sample-query">What social impact initiatives are described in this document?</div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/atomic-core.js') }}"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const uploadArea = document.getElementById('upload-area');
    const fileInput = document.getElementById('file-input');
    const browseButton = document.getElementById('browse-button');
    const fileList = document.getElementById('file-list');
    const documentPreview = document.getElementById('document-preview');
    const previewContent = document.getElementById('preview-content');
    const closePreview = document.getElementById('close-preview');
    const analysisResult = document.getElementById('analysis-result');
    
    // Handle drag and drop events
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      uploadArea.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(eventName => {
      uploadArea.addEventListener(eventName, highlight, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
      uploadArea.addEventListener(eventName, unhighlight, false);
    });
    
    function highlight() {
      uploadArea.classList.add('st-drag-active');
    }
    
    function unhighlight() {
      uploadArea.classList.remove('st-drag-active');
    }
    
    uploadArea.addEventListener('drop', handleDrop, false);
    
    function handleDrop(e) {
      const dt = e.dataTransfer;
      const files = dt.files;
      handleFiles(files);
    }
    
    browseButton.addEventListener('click', () => {
      fileInput.click();
    });
    
    fileInput.addEventListener('change', () => {
      handleFiles(fileInput.files);
    });
    
    function handleFiles(files) {
      if (files.length === 0) return;
      
      fileList.innerHTML = '';
      
      Array.from(files).forEach(file => {
        addFileToList(file);
      });
      
      // Show document preview for the first file
      if (files.length > 0) {
        showDocumentPreview(files[0]);
      }
    }
    
    function addFileToList(file) {
      const fileItem = document.createElement('div');
      fileItem.className = 'st-file-item';
      
      const fileSize = formatFileSize(file.size);
      
      fileItem.innerHTML = `
        <div class="st-file-item__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
        </div>
        <div class="st-file-item__name">${file.name}</div>
        <div class="st-file-item__size">${fileSize}</div>
        <button class="st-file-item__remove">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      `;
      
      const removeButton = fileItem.querySelector('.st-file-item__remove');
      removeButton.addEventListener('click', () => {
        fileItem.remove();
        if (fileList.children.length === 0) {
          documentPreview.style.display = 'none';
        }
      });
      
      fileList.appendChild(fileItem);
    }
    
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    function showDocumentPreview(file) {
      if (file.type === 'application/pdf' || 
          file.type.includes('word') || 
          file.type.includes('text') ||
          file.name.endsWith('.pdf') ||
          file.name.endsWith('.doc') ||
          file.name.endsWith('.docx') ||
          file.name.endsWith('.txt')) {
        
        // For a real implementation, we would generate a preview here
        // For now, we just show a mock preview
        
        const reader = new FileReader();
        
        reader.onload = function(e) {
          if (file.type.includes('text') || file.name.endsWith('.txt')) {
            previewContent.textContent = e.target.result.slice(0, 1000) + '...';
          } else {
            // Mock preview for PDF and Word documents
            previewContent.innerHTML = `
              <div class="st-preview-mock">
                <p><strong>Document Name:</strong> ${file.name}</p>
                <p><strong>Size:</strong> ${formatFileSize(file.size)}</p>
                <p><strong>Type:</strong> ${file.type || 'Unknown'}</p>
                <p>Preview generation is in progress. In the full implementation, this would show an actual preview of the document's content.</p>
              </div>
            `;
          }
          
          documentPreview.style.display = 'block';
        };
        
        if (file.type.includes('text') || file.name.endsWith('.txt')) {
          reader.readAsText(file);
        } else {
          // For non-text files, just trigger the onload event
          reader.onload();
        }
      }
    }
    
    closePreview.addEventListener('click', () => {
      documentPreview.style.display = 'none';
    });
  });
</script>
{% endblock %}