{% extends "base.html" %}

{% block title %}Sustainability Trend Analysis | SustainaTrendâ„¢{% endblock %}

{% block additional_head %}
<script src="https://cdn.plot.ly/plotly-2.29.0.min.js"></script>
{% endblock %}

{% block additional_css %}
<style>
    /* Finchat.io Inspired UI */
    :root {
        --fc-primary: #0ea5e9;
        --fc-primary-hover: #0284c7;
        --fc-bg: #f8fafc;
        --fc-card-bg: #ffffff;
        --fc-text: #0f172a;
        --fc-text-secondary: #64748b;
        --fc-border: #e2e8f0;
        --fc-success: #10b981;
        --fc-warning: #f59e0b;
        --fc-error: #ef4444;
        --fc-info: #3b82f6;
        --fc-radius: 8px;
        --fc-radius-lg: 12px;
        --fc-radius-xl: 16px;
        --fc-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --fc-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --fc-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    }
    
    .dark-mode {
        --fc-bg: #0f172a;
        --fc-card-bg: #1e293b;
        --fc-text: #f8fafc;
        --fc-text-secondary: #94a3b8;
        --fc-border: #334155;
    }
    
    body {
        background-color: var(--fc-bg);
        color: var(--fc-text);
        font-family: 'Inter', system-ui, -apple-system, sans-serif;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        line-height: 1.5;
    }
    
    /* Main Layout */
    .fc-container {
        max-width: 1024px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .fc-main {
        margin-top: 20px;
    }
    
    /* Header */
    .fc-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 0;
        border-bottom: 1px solid var(--fc-border);
        margin-bottom: 24px;
    }
    
    .fc-logo {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 600;
        font-size: 18px;
        color: var(--fc-primary);
    }
    
    .fc-nav {
        display: flex;
        gap: 16px;
        align-items: center;
    }
    
    .fc-nav-item {
        font-size: 14px;
        font-weight: 500;
        color: var(--fc-text-secondary);
        text-decoration: none;
        transition: color 0.2s;
        cursor: pointer;
    }
    
    .fc-nav-item:hover, .fc-nav-item.active {
        color: var(--fc-primary);
    }
    
    .fc-user-menu {
        display: flex;
        align-items: center;
        gap: 8px;
        background-color: var(--fc-card-bg);
        border: 1px solid var(--fc-border);
        border-radius: 20px;
        padding: 6px 12px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .fc-user-menu:hover {
        border-color: var(--fc-primary);
    }
    
    /* AI Copilot Interface */
    .fc-copilot {
        display: flex;
        flex-direction: column;
        background-color: var(--fc-card-bg);
        border-radius: var(--fc-radius-xl);
        border: 1px solid var(--fc-border);
        box-shadow: var(--fc-shadow-lg);
        overflow: hidden;
        margin-bottom: 30px;
    }
    
    .fc-copilot-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 20px;
        border-bottom: 1px solid var(--fc-border);
        background-color: rgba(var(--primary-rgb), 0.05);
    }
    
    .fc-copilot-title {
        font-size: 16px;
        font-weight: 600;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--fc-primary);
    }
    
    .fc-copilot-actions {
        display: flex;
        gap: 10px;
    }
    
    .fc-copilot-btn {
        background: transparent;
        border: 1px solid var(--fc-border);
        border-radius: var(--fc-radius);
        padding: 6px 10px;
        font-size: 13px;
        display: flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .fc-copilot-btn:hover {
        background-color: rgba(var(--primary-rgb), 0.05);
        border-color: var(--fc-primary);
    }
    
    .fc-copilot-content {
        padding: 20px;
        height: 160px;
        overflow-y: auto;
    }
    
    .fc-copilot-message {
        background-color: rgba(var(--primary-rgb), 0.05);
        border-radius: var(--fc-radius-lg);
        padding: 16px;
        margin-bottom: 16px;
        font-size: 15px;
        line-height: 1.6;
    }
    
    .fc-copilot-input-container {
        display: flex;
        padding: 12px 20px;
        border-top: 1px solid var(--fc-border);
        background-color: var(--fc-card-bg);
    }
    
    .fc-copilot-input {
        flex: 1;
        border: 1px solid var(--fc-border);
        border-radius: var(--fc-radius-lg);
        padding: 12px 16px;
        font-size: 14px;
        background-color: var(--fc-bg);
        color: var(--fc-text);
        outline: none;
        transition: all 0.2s;
    }
    
    .fc-copilot-input:focus {
        border-color: var(--fc-primary);
        box-shadow: 0 0 0 2px rgba(14, 165, 233, 0.2);
    }
    
    .fc-copilot-submit {
        background-color: var(--fc-primary);
        color: white;
        border: none;
        border-radius: var(--fc-radius);
        padding: 0 16px;
        margin-left: 8px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .fc-copilot-submit:hover {
        background-color: var(--fc-primary-hover);
    }
    
    /* Category Filters */
    .fc-category-filters {
        display: flex;
        gap: 8px;
        margin-bottom: 24px;
        flex-wrap: wrap;
    }
    
    .fc-category-filter {
        background-color: var(--fc-card-bg);
        border: 1px solid var(--fc-border);
        border-radius: var(--fc-radius);
        padding: 6px 12px;
        font-size: 13px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .fc-category-filter:hover, .fc-category-filter.active {
        background-color: rgba(var(--primary-rgb), 0.05);
        border-color: var(--fc-primary);
        color: var(--fc-primary);
    }
    
    /* Section Cards */
    .fc-section {
        margin-bottom: 30px;
    }
    
    .fc-section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 16px;
    }
    
    .fc-section-title {
        font-size: 18px;
        font-weight: 600;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    /* Trend Radar */
    .fc-trend-radar {
        background-color: var(--fc-card-bg);
        border-radius: var(--fc-radius-lg);
        border: 1px solid var(--fc-border);
        padding: 24px;
        box-shadow: var(--fc-shadow);
        margin-bottom: 24px;
    }
    
    .fc-trend-radar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .fc-trend-radar-title {
        font-size: 18px;
        font-weight: 600;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .fc-trend-radar-controls {
        display: flex;
        gap: 8px;
    }
    
    .fc-trend-radar-control {
        background: transparent;
        border: 1px solid var(--fc-border);
        border-radius: var(--fc-radius);
        padding: 4px 10px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .fc-trend-radar-control:hover, .fc-trend-radar-control.active {
        background-color: rgba(var(--primary-rgb), 0.05);
        border-color: var(--fc-primary);
        color: var(--fc-primary);
    }
    
    .fc-trend-radar-container {
        height: 450px;
        width: 100%;
    }
    
    /* Trend Grid */
    .fc-trend-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .fc-trend-card {
        background-color: var(--fc-card-bg);
        border-radius: var(--fc-radius-lg);
        border: 1px solid var(--fc-border);
        padding: 20px;
        box-shadow: var(--fc-shadow);
        transition: all 0.2s;
        position: relative;
        overflow: hidden;
    }
    
    .fc-trend-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--fc-shadow-md);
        border-color: var(--fc-primary);
    }
    
    .fc-trend-virality {
        position: absolute;
        top: 0;
        right: 0;
        padding: 4px 12px;
        font-size: 12px;
        font-weight: 600;
        color: white;
    }
    
    .fc-trend-virality.high {
        background-color: var(--fc-success);
    }
    
    .fc-trend-virality.medium {
        background-color: var(--fc-warning);
    }
    
    .fc-trend-virality.low {
        background-color: var(--fc-info);
    }
    
    .fc-trend-category {
        display: inline-block;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
        margin-bottom: 12px;
        background-color: rgba(var(--primary-rgb), 0.1);
        color: var(--fc-primary);
    }
    
    .fc-trend-title {
        font-size: 16px;
        font-weight: 600;
        margin: 0 0 12px 0;
        color: var(--fc-text);
    }
    
    .fc-trend-description {
        font-size: 14px;
        color: var(--fc-text-secondary);
        margin-bottom: 16px;
        line-height: 1.5;
    }
    
    .fc-trend-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid var(--fc-border);
        font-size: 13px;
        color: var(--fc-text-secondary);
    }
    
    .fc-trend-sentiment {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .fc-trend-sentiment.positive {
        color: var(--fc-success);
    }
    
    .fc-trend-sentiment.negative {
        color: var(--fc-error);
    }
    
    .fc-trend-sentiment.neutral {
        color: var(--fc-info);
    }
    
    /* Prediction Card */
    .fc-prediction-card {
        background-color: var(--fc-card-bg);
        border-radius: var(--fc-radius-lg);
        border: 1px solid var(--fc-border);
        padding: 24px;
        box-shadow: var(--fc-shadow);
        margin-bottom: 30px;
    }
    
    .fc-prediction-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
    }
    
    .fc-prediction-title {
        font-size: 18px;
        font-weight: 600;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .fc-prediction-timeframes {
        display: flex;
        gap: 8px;
    }
    
    .fc-prediction-timeframe {
        background: transparent;
        border: 1px solid var(--fc-border);
        border-radius: var(--fc-radius);
        padding: 4px 10px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .fc-prediction-timeframe:hover, .fc-prediction-timeframe.active {
        background-color: rgba(var(--primary-rgb), 0.05);
        border-color: var(--fc-primary);
        color: var(--fc-primary);
    }
    
    .fc-prediction-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }
    
    .fc-prediction-chart {
        height: 300px;
    }
    
    .fc-prediction-insights {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }
    
    .fc-prediction-insight {
        display: flex;
        gap: 12px;
        align-items: flex-start;
        padding: 16px;
        background-color: var(--fc-bg);
        border-radius: var(--fc-radius);
    }
    
    .fc-prediction-insight-icon {
        width: 32px;
        height: 32px;
        border-radius: var(--fc-radius);
        background-color: rgba(var(--primary-rgb), 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--fc-primary);
        flex-shrink: 0;
    }
    
    .fc-prediction-insight-content h4 {
        font-size: 14px;
        font-weight: 600;
        margin: 0 0 6px 0;
        color: var(--fc-text);
    }
    
    .fc-prediction-insight-content p {
        font-size: 13px;
        margin: 0;
        color: var(--fc-text-secondary);
    }
    
    /* AI Analysis Card */
    .fc-analysis-card {
        background-color: var(--fc-card-bg);
        border-radius: var(--fc-radius-lg);
        border: 1px solid var(--fc-border);
        padding: 24px;
        box-shadow: var(--fc-shadow);
        margin-bottom: 30px;
    }
    
    .fc-analysis-header {
        margin-bottom: 20px;
    }
    
    .fc-analysis-title {
        font-size: 18px;
        font-weight: 600;
        margin: 0 0 8px 0;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .fc-analysis-subtitle {
        font-size: 14px;
        color: var(--fc-text-secondary);
        margin: 0;
    }
    
    .fc-analysis-content {
        font-size: 15px;
        line-height: 1.6;
        color: var(--fc-text);
        margin-bottom: 20px;
    }
    
    .fc-analysis-highlight {
        background-color: rgba(var(--primary-rgb), 0.1);
        color: var(--fc-primary);
        padding: 1px 4px;
        border-radius: 4px;
        font-weight: 500;
    }
    
    .fc-analysis-metrics {
        display: flex;
        gap: 16px;
        margin: 20px 0;
        flex-wrap: wrap;
    }
    
    .fc-analysis-metric {
        background-color: var(--fc-bg);
        border-radius: var(--fc-radius);
        padding: 16px;
        flex: 1;
        min-width: 120px;
        text-align: center;
    }
    
    .fc-analysis-metric-value {
        font-size: 24px;
        font-weight: 700;
        color: var(--fc-primary);
        margin-bottom: 4px;
    }
    
    .fc-analysis-metric-label {
        font-size: 13px;
        color: var(--fc-text-secondary);
    }
    
    /* Toast */
    .fc-toast {
        position: fixed;
        bottom: 24px;
        right: 24px;
        background-color: var(--fc-card-bg);
        border: 1px solid var(--fc-border);
        border-radius: var(--fc-radius);
        padding: 12px 16px;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: var(--fc-shadow-md);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1000;
    }
    
    .fc-toast.visible {
        opacity: 1;
    }
    
    /* Responsive Adjustments */
    @media (max-width: 768px) {
        .fc-trend-grid {
            grid-template-columns: 1fr;
        }
        
        .fc-prediction-content {
            grid-template-columns: 1fr;
        }
        
        .fc-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 16px;
        }
        
        .fc-nav {
            width: 100%;
            overflow-x: auto;
            padding-bottom: 8px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="fc-container">
    <!-- Header -->
    <header class="fc-header">
        <div class="fc-logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v8"/><path d="M12 18v4"/><path d="M4.93 10.93 9.17 15.17"/><path d="M14.83 15.17l4.24-4.24"/><path d="M19.07 10.93 14.83 6.7"/><path d="M14.83 6.7 12 3.87 9.17 6.7 4.93 10.93l4.24 4.24L12 18.13l2.83-2.83 4.24-4.24z"/></svg>
            <span>SustainaTrendâ„¢</span>
        </div>
        
        <nav class="fc-nav">
            <a class="fc-nav-item" href="/">Dashboard</a>
            <a class="fc-nav-item active" href="/trend-analysis">Trends</a>
            <a class="fc-nav-item" href="/sustainability-stories">Stories</a>
            <a class="fc-nav-item" href="/document-upload">Documents</a>
        </nav>
        
        <div class="fc-user-menu">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg>
            <span>Trend Analysis</span>
        </div>
    </header>
    
    <!-- AI Copilot (Finchat-style primary interaction) -->
    <div class="fc-copilot">
        <div class="fc-copilot-header">
            <h2 class="fc-copilot-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>
                What sustainability trends are you interested in?
            </h2>
            <div class="fc-copilot-actions">
                <button class="fc-copilot-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                    Export
                </button>
                <button class="fc-copilot-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5.52 19c.64-2.2 1.84-3 3.22-3h6.52c1.38 0 2.58.8 3.22 3"/><circle cx="12" cy="10" r="3"/><circle cx="12" cy="12" r="10"/></svg>
                    Share
                </button>
            </div>
        </div>
        <div class="fc-copilot-content">
            <div class="fc-copilot-message">
                <p>I can help you analyze sustainability trends and predict their impact. Try asking:</p>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li>What's the virality of renewable energy trends this quarter?</li>
                    <li>How is the sentiment around carbon emissions evolving?</li>
                    <li>Show me the most important emerging trends in water conservation</li>
                </ul>
            </div>
        </div>
        <div class="fc-copilot-input-container">
            <input type="text" class="fc-copilot-input" placeholder="Ask about sustainability trends, sentiment analysis, or predictions..." id="copilot-input">
            <button class="fc-copilot-submit" id="copilot-submit">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
            </button>
        </div>
    </div>
    
    <!-- Category Filters -->
    <div class="fc-category-filters">
        <div class="fc-category-filter active">All Categories</div>
        <div class="fc-category-filter">Emissions</div>
        <div class="fc-category-filter">Energy</div>
        <div class="fc-category-filter">Water</div>
        <div class="fc-category-filter">Waste</div>
        <div class="fc-category-filter">Social</div>
    </div>
    
    <!-- Trend Radar (Interactive Visualization) -->
    <div class="fc-trend-radar">
        <div class="fc-trend-radar-header">
            <h2 class="fc-trend-radar-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>
                Sustainability Trend Radar
            </h2>
            <div class="fc-trend-radar-controls">
                <button class="fc-trend-radar-control active">Last 30 Days</button>
                <button class="fc-trend-radar-control">Last Quarter</button>
                <button class="fc-trend-radar-control">YTD</button>
            </div>
        </div>
        <div class="fc-trend-radar-container" id="trend-radar-chart"></div>
    </div>
    
    <!-- Today's Key Trends -->
    <div class="fc-section">
        <div class="fc-section-header">
            <h2 class="fc-section-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg>
                Today's Key Trends
            </h2>
        </div>
        
        <div class="fc-trend-grid">
            <!-- Trend 1 -->
            <div class="fc-trend-card">
                <div class="fc-trend-virality high">High Virality</div>
                <div class="fc-trend-category">Energy</div>
                <h3 class="fc-trend-title">Green Hydrogen Adoption Accelerating</h3>
                <div class="fc-trend-description">
                    Green hydrogen initiatives are gaining significant momentum as more companies invest in production capacity and infrastructure. Market projections show a 35% growth over the next year.
                </div>
                <div class="fc-trend-meta">
                    <div class="fc-trend-sentiment positive">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></svg>
                        Positive Sentiment
                    </div>
                    <span>Updated 2 hours ago</span>
                </div>
            </div>
            
            <!-- Trend 2 -->
            <div class="fc-trend-card">
                <div class="fc-trend-virality medium">Medium Virality</div>
                <div class="fc-trend-category">Emissions</div>
                <h3 class="fc-trend-title">Carbon Capturing Technology Breakthrough</h3>
                <div class="fc-trend-description">
                    New carbon capture technology showing 40% efficiency improvement in pilot projects. Industry adoption is expected to accelerate as costs decrease and regulatory pressure increases.
                </div>
                <div class="fc-trend-meta">
                    <div class="fc-trend-sentiment positive">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></svg>
                        Positive Sentiment
                    </div>
                    <span>Updated 3 hours ago</span>
                </div>
            </div>
            
            <!-- Trend 3 -->
            <div class="fc-trend-card">
                <div class="fc-trend-virality high">High Virality</div>
                <div class="fc-trend-category">Social</div>
                <h3 class="fc-trend-title">Supplier Scope 3 Reporting Requirements</h3>
                <div class="fc-trend-description">
                    Growing trend of companies requiring Scope 3 emissions reporting from their suppliers, with a 78% increase in reporting requirements across major industries in the last quarter.
                </div>
                <div class="fc-trend-meta">
                    <div class="fc-trend-sentiment neutral">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="8" y1="12" x2="16" y2="12"></line><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></svg>
                        Neutral Sentiment
                    </div>
                    <span>Updated 5 hours ago</span>
                </div>
            </div>
            
            <!-- Trend 4 -->
            <div class="fc-trend-card">
                <div class="fc-trend-virality medium">Medium Virality</div>
                <div class="fc-trend-category">Water</div>
                <h3 class="fc-trend-title">Decentralized Water Purification Systems</h3>
                <div class="fc-trend-description">
                    Innovative decentralized water purification systems gaining traction in water-stressed regions, with a 25% increase in implementation across manufacturing facilities.
                </div>
                <div class="fc-trend-meta">
                    <div class="fc-trend-sentiment positive">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></svg>
                        Positive Sentiment
                    </div>
                    <span>Updated 8 hours ago</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Predictive Analysis -->
    <div class="fc-prediction-card">
        <div class="fc-prediction-header">
            <h2 class="fc-prediction-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/><path d="m13 13 6 6"/></svg>
                Predictive Trend Analysis
            </h2>
            <div class="fc-prediction-timeframes">
                <button class="fc-prediction-timeframe active">3 Months</button>
                <button class="fc-prediction-timeframe">6 Months</button>
                <button class="fc-prediction-timeframe">12 Months</button>
            </div>
        </div>
        <div class="fc-prediction-content">
            <div class="fc-prediction-chart" id="prediction-chart"></div>
            <div class="fc-prediction-insights">
                <div class="fc-prediction-insight">
                    <div class="fc-prediction-insight-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg>
                    </div>
                    <div class="fc-prediction-insight-content">
                        <h4>Rising Regulatory Pressure (93% confidence)</h4>
                        <p>AI models predict significant increases in climate-related regulatory requirements within the next 3-6 months, particularly affecting energy and manufacturing sectors.</p>
                    </div>
                </div>
                <div class="fc-prediction-insight">
                    <div class="fc-prediction-insight-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2 3 14h9l-1 8 10-12h-9l1-8z"/></svg>
                    </div>
                    <div class="fc-prediction-insight-content">
                        <h4>Renewable Energy Integration (87% confidence)</h4>
                        <p>Trend analysis indicates accelerating adoption of integrated renewable energy systems, with projected cost parity with traditional sources in key markets within 3 months.</p>
                    </div>
                </div>
                <div class="fc-prediction-insight">
                    <div class="fc-prediction-insight-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    </div>
                    <div class="fc-prediction-insight-content">
                        <h4>Emerging Risk: Supply Chain Disruption (78% confidence)</h4>
                        <p>Predictive models show increased likelihood of climate-related supply chain disruptions in the next quarter, affecting primarily agricultural and semiconductor inputs.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- AI-Generated Trend Analysis -->
    <div class="fc-analysis-card">
        <div class="fc-analysis-header">
            <h2 class="fc-analysis-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m2 12 10 5 10-5"/><path d="M12 2v10"/><path d="m4.93 4.93 4.24 4.24"/><path d="M19.07 4.93 14.83 9.17"/></svg>
                AI-Generated Trend Analysis
            </h2>
            <p class="fc-analysis-subtitle">Updated March 11, 2025 - Generated from 1,250+ sustainability data sources</p>
        </div>
        <div class="fc-analysis-content">
            <p>Analysis of current sustainability trends reveals significant momentum in three key areas: <span class="fc-analysis-highlight">renewable energy integration</span>, <span class="fc-analysis-highlight">emissions reporting standards</span>, and <span class="fc-analysis-highlight">water conservation technology</span>.</p>
            
            <p>Renewable energy initiatives show the strongest growth trajectory (+35% YoY) with particular acceleration in green hydrogen and integrating battery storage into existing renewable installations. Market sentiment is strongly positive with institutional investment increasing 28% in Q1 2025.</p>
            
            <p>Corporate emissions reporting frameworks are experiencing increased standardization as regulatory bodies align requirements. This is creating both challenges and opportunities, with the most proactive organizations gaining competitive advantage through early adoption of advanced measurement systems.</p>
            
            <div class="fc-analysis-metrics">
                <div class="fc-analysis-metric">
                    <div class="fc-analysis-metric-value">+35%</div>
                    <div class="fc-analysis-metric-label">Renewable Growth</div>
                </div>
                <div class="fc-analysis-metric">
                    <div class="fc-analysis-metric-value">82%</div>
                    <div class="fc-analysis-metric-label">Positive Sentiment</div>
                </div>
                <div class="fc-analysis-metric">
                    <div class="fc-analysis-metric-value">3.7x</div>
                    <div class="fc-analysis-metric-label">Investment Multiplier</div>
                </div>
            </div>
            
            <p>Water conservation technologies are showing promising innovation in decentralized treatment and closed-loop systems. Industry adoption is accelerating in water-stressed regions (+65%) but remains slower in regions without immediate water scarcity concerns (+12%).</p>
            
            <p>Looking forward, we anticipate continued acceleration in these trend areas with the addition of <span class="fc-analysis-highlight">biodiversity impact measurement</span> as an emerging focus area in the next 6-9 months.</p>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div class="fc-toast" id="toast">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
        <span id="toast-message">Trend analysis updated</span>
    </div>
</div>
{% endblock %}

{% block additional_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize trend radar chart
        initializeTrendRadarChart();
        
        // Initialize prediction chart
        initializePredictionChart();
        
        // Set up Copilot interaction
        setupCopilot();
        
        // Set up category filters
        setupCategoryFilters();
        
        // Set up prediction timeframes
        setupPredictionTimeframes();
    });
    
    // Initialize trend radar chart
    function initializeTrendRadarChart() {
        const chartElement = document.getElementById('trend-radar-chart');
        
        const data = [{
            type: 'scatterpolar',
            r: [87, 78, 92, 65, 81],
            theta: ['Emissions', 'Energy', 'Social', 'Water', 'Waste'],
            fill: 'toself',
            name: 'Virality Score',
            line: {
                color: '#0ea5e9'
            }
        }, {
            type: 'scatterpolar',
            r: [72, 58, 86, 51, 63],
            theta: ['Emissions', 'Energy', 'Social', 'Water', 'Waste'],
            fill: 'toself',
            name: 'Last Period',
            line: {
                color: 'rgba(14, 165, 233, 0.3)'
            }
        }];
        
        const layout = {
            polar: {
                radialaxis: {
                    visible: true,
                    range: [0, 100]
                }
            },
            showlegend: true,
            legend: {
                orientation: 'h',
                y: -0.2
            },
            margin: {
                l: 50,
                r: 50,
                t: 50,
                b: 50
            },
            plot_bgcolor: 'transparent',
            paper_bgcolor: 'transparent',
            font: {
                color: getComputedStyle(document.documentElement).getPropertyValue('--fc-text')
            }
        };
        
        Plotly.newPlot(chartElement, data, layout, {responsive: true});
    }
    
    // Initialize prediction chart
    function initializePredictionChart() {
        const chartElement = document.getElementById('prediction-chart');
        
        const currentData = {
            x: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            y: [64, 68, 72, 76, 81, 87],
            type: 'scatter',
            mode: 'lines+markers',
            name: 'Historical Trend',
            line: {
                color: '#0ea5e9',
                width: 3
            },
            marker: {
                size: 8
            }
        };
        
        const predictedData = {
            x: ['Jul', 'Aug', 'Sep'],
            y: [92, 96, 98],
            type: 'scatter',
            mode: 'lines+markers',
            name: 'Predicted Trend',
            line: {
                color: '#10b981',
                width: 3,
                dash: 'dot'
            },
            marker: {
                size: 8
            }
        };
        
        const layout = {
            title: 'Renewable Energy Adoption Trajectory',
            autosize: true,
            margin: {
                l: 50,
                r: 20,
                b: 50,
                t: 30,
                pad: 4
            },
            xaxis: {
                title: 'Month (2025)'
            },
            yaxis: {
                title: 'Adoption Index'
            },
            legend: {
                orientation: 'h',
                y: -0.2
            },
            plot_bgcolor: 'transparent',
            paper_bgcolor: 'transparent',
            font: {
                color: getComputedStyle(document.documentElement).getPropertyValue('--fc-text')
            }
        };
        
        Plotly.newPlot(chartElement, [currentData, predictedData], layout, {responsive: true});
    }
    
    // Set up Copilot interaction
    function setupCopilot() {
        const contentElement = document.querySelector('.fc-copilot-content');
        const inputElement = document.getElementById('copilot-input');
        const submitButton = document.getElementById('copilot-submit');
        
        // Handle submit click
        submitButton.addEventListener('click', function() {
            handleCopilotRequest();
        });
        
        // Handle enter key press
        inputElement.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                handleCopilotRequest();
            }
        });
        
        function handleCopilotRequest() {
            const query = inputElement.value.trim();
            if (!query) return;
            
            // Add user message to the chat
            const userMessageHTML = `
                <div class="fc-copilot-message" style="background-color: rgba(14, 165, 233, 0.1); margin-left: 20%;">
                    <p>${query}</p>
                </div>
            `;
            contentElement.innerHTML += userMessageHTML;
            
            // Clear input
            inputElement.value = '';
            
            // Scroll to bottom
            contentElement.scrollTop = contentElement.scrollHeight;
            
            // Show typing indicator
            const indicatorHTML = `
                <div class="fc-copilot-message" id="typing-indicator">
                    <p>Analyzing trends...</p>
                </div>
            `;
            contentElement.innerHTML += indicatorHTML;
            contentElement.scrollTop = contentElement.scrollHeight;
            
            // Simulate AI response
            setTimeout(() => {
                // Remove typing indicator
                document.getElementById('typing-indicator').remove();
                
                // Add AI response
                const responseHTML = generateCopilotResponse(query);
                contentElement.innerHTML += responseHTML;
                
                // Scroll to bottom
                contentElement.scrollTop = contentElement.scrollHeight;
            }, 1500);
        }
        
        // Simple response generation
        function generateCopilotResponse(query) {
            let response = '';
            
            // Match query to potential responses
            const queryLower = query.toLowerCase();
            
            if (queryLower.includes('renewable') || queryLower.includes('energy')) {
                response = `
                    <div class="fc-copilot-message">
                        <p>Analyzing renewable energy trends:</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Virality score: 78/100 (up 20 points from last quarter)</li>
                            <li>Sentiment: 82% positive (up 15% from last quarter)</li>
                            <li>Key focus: Green hydrogen and battery storage integration</li>
                        </ul>
                        <p style="margin-top: 10px;">Major corporations are accelerating renewable adoption. The trend is projected to continue with 35% year-over-year growth. Green hydrogen initiatives show the highest momentum increase.</p>
                    </div>
                `;
            } else if (queryLower.includes('carbon') || queryLower.includes('emission')) {
                response = `
                    <div class="fc-copilot-message">
                        <p>Carbon emissions trend analysis:</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Virality score: 87/100 (up 15 points from last quarter)</li>
                            <li>Sentiment: 65% positive, 25% neutral, 10% negative</li>
                            <li>Key developments: Carbon capture technology, Scope 3 reporting requirements</li>
                        </ul>
                        <p style="margin-top: 10px;">The most significant trend is the 78% increase in companies requiring Scope 3 emissions reporting from suppliers. Carbon capturing technologies are showing promising efficiency improvements (up 40% in latest pilots).</p>
                    </div>
                `;
            } else if (queryLower.includes('water')) {
                response = `
                    <div class="fc-copilot-message">
                        <p>Water conservation trend analysis:</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Virality score: 65/100 (up 14 points from last quarter)</li>
                            <li>Sentiment: 78% positive, 18% neutral, 4% negative</li>
                            <li>Key developments: Decentralized purification, Closed-loop systems</li>
                        </ul>
                        <p style="margin-top: 10px;">Water conservation technology adoption shows significant regional variation: +65% in water-stressed regions vs. +12% elsewhere. Decentralized water purification systems are gaining the most traction with 25% implementation growth in manufacturing.</p>
                    </div>
                `;
            } else if (queryLower.includes('sentiment')) {
                response = `
                    <div class="fc-copilot-message">
                        <p>Sustainability sentiment analysis across trends:</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Renewable Energy: 82% positive (â–²15%)</li>
                            <li>Carbon Emissions: 65% positive (â–²8%)</li>
                            <li>Water Conservation: 78% positive (â–²12%)</li>
                            <li>Waste Management: 63% positive (â–²5%)</li>
                            <li>Social Governance: 86% positive (â–²18%)</li>
                        </ul>
                        <p style="margin-top: 10px;">Social governance shows the largest sentiment improvement as companies increase transparency and stakeholder engagement. Renewable energy maintains the strongest overall positive sentiment driven by cost efficiencies and policy support.</p>
                    </div>
                `;
            } else {
                response = `
                    <div class="fc-copilot-message">
                        <p>Here's the current sustainability trend landscape:</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Highest virality: Social governance (92/100) and emissions reporting (87/100)</li>
                            <li>Fastest growing: Renewable energy adoption (+35% YoY)</li>
                            <li>Emerging trend: Biodiversity impact measurement (new this quarter)</li>
                        </ul>
                        <p style="margin-top: 10px;">The most significant development is the acceleration of Scope 3 emissions reporting requirements across supply chains. This is creating both challenges and competitive opportunities as organizations adapt to more comprehensive measurement systems.</p>
                    </div>
                `;
            }
            
            return response;
        }
    }
    
    // Set up category filters
    function setupCategoryFilters() {
        const filters = document.querySelectorAll('.fc-category-filter');
        
        filters.forEach(filter => {
            filter.addEventListener('click', function() {
                // Remove active class from all filters
                filters.forEach(f => f.classList.remove('active'));
                
                // Add active class to clicked filter
                this.classList.add('active');
                
                // Show toast notification
                showToast(`Filtered to show ${this.textContent} trends`);
                
                // In a real implementation, this would filter the displayed trends
                // For this demo, we'll just show a notification
            });
        });
    }
    
    // Set up prediction timeframes
    function setupPredictionTimeframes() {
        const timeframes = document.querySelectorAll('.fc-prediction-timeframe');
        
        timeframes.forEach(timeframe => {
            timeframe.addEventListener('click', function() {
                // Remove active class from all timeframes
                timeframes.forEach(t => t.classList.remove('active'));
                
                // Add active class to clicked timeframe
                this.classList.add('active');
                
                // Show toast notification
                showToast(`Prediction timeframe updated to ${this.textContent}`);
                
                // In a real implementation, this would update the prediction chart
                // For this demo, we'll just show a notification
            });
        });
    }
    
    // Toast notification
    function showToast(message) {
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        
        // Set message
        toastMessage.textContent = message;
        
        // Show toast
        toast.classList.add('visible');
        
        // Auto hide after 3 seconds
        setTimeout(() => {
            toast.classList.remove('visible');
        }, 3000);
    }
</script>
{% endblock %}