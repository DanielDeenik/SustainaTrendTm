{% extends "layouts/collapsible_layout.html" %}

{% block title %}Sustainability Intelligence | SustainaTrendâ„¢ Platform{% endblock %}

{% block header_title %}Corporate Sustainability Intelligence{% endblock %}

{% block additional_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/chart-components.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/metric-components.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/realtime-updates.css') }}">
{% endblock %}

{% block content %}
<div class="st-container">
    <div class="st-grid-layout">
        <div class="st-section">
            <div class="st-card">
                <div class="st-card-header">
                    <h2>Sustainability Overview</h2>
                    <div class="st-card-actions">
                        <button class="st-btn-icon" title="Refresh Data">
                            <span class="material-icons">refresh</span>
                        </button>
                    </div>
                </div>
                <div class="st-card-content">
                    <div class="st-stats-row">
                        <div class="st-stat-card primary">
                            <span class="st-stat-value">76</span>
                            <span class="st-stat-label">ESG Score</span>
                            <span class="st-stat-change positive">+4.2%</span>
                        </div>
                        <div class="st-stat-card success">
                            <span class="st-stat-value">57%</span>
                            <span class="st-stat-label">Carbon Reduction</span>
                            <span class="st-stat-change positive">+12%</span>
                        </div>
                        <div class="st-stat-card warning">
                            <span class="st-stat-value">32%</span>
                            <span class="st-stat-label">Water Usage</span>
                            <span class="st-stat-change negative">+5%</span>
                        </div>
                        <div class="st-stat-card info">
                            <span class="st-stat-value">89%</span>
                            <span class="st-stat-label">ESRS Compliance</span>
                            <span class="st-stat-change positive">+14%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="st-section st-section-row">
            <div class="st-card">
                <div class="st-card-header">
                    <h2>Environmental Impact</h2>
                </div>
                <div class="st-card-content">
                    <div id="environmental-chart" class="st-chart"></div>
                </div>
            </div>
            <div class="st-card">
                <div class="st-card-header">
                    <h2>Social Responsibility</h2>
                </div>
                <div class="st-card-content">
                    <div id="social-chart" class="st-chart"></div>
                </div>
            </div>
        </div>

        <div class="st-section">
            <div class="st-card">
                <div class="st-card-header">
                    <h2>ESRS Framework Compliance</h2>
                </div>
                <div class="st-card-content">
                    <div class="st-progress-grid">
                        <div class="st-progress-item">
                            <div class="st-progress-label">
                                <span>E1: Climate Change</span>
                                <span>92%</span>
                            </div>
                            <div class="st-progress-bar">
                                <div class="st-progress-fill" style="width: 92%"></div>
                            </div>
                        </div>
                        <div class="st-progress-item">
                            <div class="st-progress-label">
                                <span>E2: Pollution</span>
                                <span>78%</span>
                            </div>
                            <div class="st-progress-bar">
                                <div class="st-progress-fill" style="width: 78%"></div>
                            </div>
                        </div>
                        <div class="st-progress-item">
                            <div class="st-progress-label">
                                <span>E3: Water & Marine Resources</span>
                                <span>64%</span>
                            </div>
                            <div class="st-progress-bar">
                                <div class="st-progress-fill" style="width: 64%"></div>
                            </div>
                        </div>
                        <div class="st-progress-item">
                            <div class="st-progress-label">
                                <span>E4: Biodiversity & Ecosystems</span>
                                <span>56%</span>
                            </div>
                            <div class="st-progress-bar">
                                <div class="st-progress-fill" style="width: 56%"></div>
                            </div>
                        </div>
                        <div class="st-progress-item">
                            <div class="st-progress-label">
                                <span>E5: Resource Usage & Circular Economy</span>
                                <span>88%</span>
                            </div>
                            <div class="st-progress-bar">
                                <div class="st-progress-fill" style="width: 88%"></div>
                            </div>
                        </div>
                        <div class="st-progress-item">
                            <div class="st-progress-label">
                                <span>S1: Own Workforce</span>
                                <span>95%</span>
                            </div>
                            <div class="st-progress-bar">
                                <div class="st-progress-fill" style="width: 95%"></div>
                            </div>
                        </div>
                        <div class="st-progress-item">
                            <div class="st-progress-label">
                                <span>S2: Workers in Value Chain</span>
                                <span>72%</span>
                            </div>
                            <div class="st-progress-bar">
                                <div class="st-progress-fill" style="width: 72%"></div>
                            </div>
                        </div>
                        <div class="st-progress-item">
                            <div class="st-progress-label">
                                <span>G1: Business Conduct</span>
                                <span>87%</span>
                            </div>
                            <div class="st-progress-bar">
                                <div class="st-progress-fill" style="width: 87%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="st-section">
            <div class="st-card">
                <div class="st-card-header">
                    <h2>Sustainability AI Co-Pilot</h2>
                </div>
                <div class="st-card-content">
                    <div class="st-copilot-hint">
                        <div class="st-copilot-hint-icon">
                            <span class="material-icons">tips_and_updates</span>
                        </div>
                        <div class="st-copilot-hint-content">
                            <p>Ask the Sustainability Co-Pilot for personalized insights on your sustainability metrics, ESRS compliance guidance, or trend analysis.</p>
                            <button class="st-btn primary" id="activate-copilot">Ask Co-Pilot</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block additional_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Environmental Impact Chart
        const environmentalData = [{
            values: [34, 26, 16, 14, 10],
            labels: ['Carbon Emissions', 'Water Usage', 'Waste Management', 'Energy Efficiency', 'Material Sourcing'],
            type: 'pie',
            marker: {
                colors: ['#4CAF50', '#2196F3', '#FFC107', '#9C27B0', '#FF5722']
            }
        }];
        
        const environmentalLayout = {
            height: 300,
            margin: { t: 0, b: 0, l: 0, r: 0 },
            showlegend: true,
            legend: { orientation: 'h' }
        };
        
        Plotly.newPlot('environmental-chart', environmentalData, environmentalLayout);
        
        // Social Responsibility Chart
        const socialData = [{
            x: ['Employee Wellbeing', 'Community Impact', 'Diversity & Inclusion', 'Human Rights', 'Supply Chain'],
            y: [85, 72, 91, 64, 58],
            type: 'bar',
            marker: {
                color: ['#4CAF50', '#2196F3', '#FFC107', '#9C27B0', '#FF5722']
            }
        }];
        
        const socialLayout = {
            height: 300,
            margin: { t: 0, b: 80, l: 50, r: 20 },
            xaxis: { tickangle: -45 }
        };
        
        Plotly.newPlot('social-chart', socialData, socialLayout);
    });
</script>
{% endblock %}