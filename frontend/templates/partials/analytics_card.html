{% macro analytics_card(title, value, unit='', subtitle='', icon='graph-up', color='primary', percent_change=None, chart_id=None) %}
<div class="card h-100 shadow-sm analytics-card {{ color }}">
  <div class="card-body d-flex flex-column">
    <div class="d-flex justify-content-between align-items-start mb-3">
      <div class="card-icon bg-{{ color }} bg-opacity-10">
        <i class="bi bi-{{ icon }}"></i>
      </div>
      {% if percent_change is not none %}
        <div class="percent-change {{ 'text-success' if percent_change > 0 else 'text-danger' if percent_change < 0 else 'text-muted' }}">
          <i class="bi bi-{{ 'arrow-up' if percent_change > 0 else 'arrow-down' if percent_change < 0 else 'dash' }}"></i>
          {{ percent_change|abs }}%
        </div>
      {% endif %}
    </div>
    <h6 class="card-subtitle text-muted mb-1">{{ title }}</h6>
    <div class="d-flex align-items-baseline mt-2">
      <h3 class="card-value mb-0">{{ value }}</h3>
      {% if unit %}
        <span class="ms-1 text-muted small">{{ unit }}</span>
      {% endif %}
    </div>
    {% if subtitle %}
      <div class="text-muted small mt-1">{{ subtitle }}</div>
    {% endif %}
    {% if chart_id %}
      <div class="mini-chart mt-auto">
        <canvas id="{{ chart_id }}" height="40"></canvas>
      </div>
    {% endif %}
  </div>
</div>
{% endmacro %}