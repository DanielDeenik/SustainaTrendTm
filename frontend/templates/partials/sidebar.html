<!-- Sidebar Navigation -->
<div class="sidebar">
    <!-- Logo and Brand -->
    <div class="sidebar-header">
        <a href="/" class="sidebar-brand">
            <span class="brand-icon"><i class="fas fa-leaf"></i></span>
            <span class="brand-text">SustainaTrendâ„¢</span>
        </a>
        <button class="sidebar-toggle" id="sidebarToggle">
            <i class="fas fa-bars"></i>
        </button>
    </div>

    <!-- Navigation Sections -->
    <div class="sidebar-content">
        <!-- Debug Info -->
        <div class="debug-info" style="margin: 10px; padding: 8px; border: 1px solid #ccc; background: #f8f8f8; font-size: 12px; color: #333;">
            <p>Nav Sections Available: {{ nav_sections is defined }}</p>
            <p>Active Nav: {{ active_nav|default('None') }}</p>
        </div>

        <!-- Core Navigation - Manual Fallback -->
        <div class="nav-section">
            <h5 class="nav-section-title">Core</h5>
            <ul class="nav-items">
                <li class="nav-item {% if active_nav == 'home' %}active{% endif %}">
                    <a href="/" class="nav-link">
                        <i class="nav-icon fas fa-home"></i>
                        <span class="nav-text">Home</span>
                    </a>
                </li>
                <li class="nav-item {% if active_nav == 'dashboard' %}active{% endif %}">
                    <a href="/dashboard" class="nav-link">
                        <i class="nav-icon fas fa-chart-bar"></i>
                        <span class="nav-text">Dashboard</span>
                    </a>
                </li>
                <li class="nav-item {% if active_nav == 'risk' %}active{% endif %}">
                    <a href="/risk-tracker" class="nav-link">
                        <i class="nav-icon fas fa-exclamation-triangle"></i>
                        <span class="nav-text">Risk Tracker</span>
                    </a>
                </li>
                <li class="nav-item {% if active_nav == 'analytics' %}active{% endif %}">
                    <a href="/analytics-dashboard" class="nav-link">
                        <i class="nav-icon fas fa-chart-line"></i>
                        <span class="nav-text">Analytics</span>
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- Insights Navigation - Manual Fallback -->
        <div class="nav-section">
            <h5 class="nav-section-title">Insights</h5>
            <ul class="nav-items">
                <li class="nav-item {% if active_nav == 'stories' %}active{% endif %}">
                    <a href="/story-cards" class="nav-link">
                        <i class="nav-icon fas fa-newspaper"></i>
                        <span class="nav-text">AI Story Cards</span>
                    </a>
                </li>
                <li class="nav-item {% if active_nav == 'monetization' %}active{% endif %}">
                    <a href="/monetization-opportunities" class="nav-link">
                        <i class="nav-icon fas fa-dollar-sign"></i>
                        <span class="nav-text">Monetization</span>
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- Tools Navigation - Manual Fallback -->
        <div class="nav-section">
            <h5 class="nav-section-title">Tools</h5>
            <ul class="nav-items">
                <li class="nav-item {% if active_nav == 'documents' %}active{% endif %}">
                    <a href="/pdf-analyzer" class="nav-link">
                        <i class="nav-icon fas fa-file-upload"></i>
                        <span class="nav-text">Upload Reports</span>
                    </a>
                </li>
                <li class="nav-item {% if active_nav == 'terminal' %}active{% endif %}">
                    <a href="/data-terminal" class="nav-link">
                        <i class="nav-icon fas fa-terminal"></i>
                        <span class="nav-text">Data Terminal</span>
                    </a>
                </li>
                <li class="nav-item {% if active_nav == 'copilot' %}active{% endif %}">
                    <a href="/co-pilot" class="nav-link">
                        <i class="nav-icon fas fa-robot"></i>
                        <span class="nav-text">AI Co-Pilot</span>
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- Dynamic sections (original code) -->
        {% if nav_sections is defined and nav_sections %}
            {% for section in nav_sections %}
            <div class="nav-section" style="display: none;"><!-- Hidden for now -->
                <h5 class="nav-section-title">{{ section.title }}</h5>
                <ul class="nav-items">
                    {% if section.items is defined and section.items is iterable and section.items is not string %}
                        {% for item in section.items %}
                        <li class="nav-item {% if active_nav == item.id %}active{% endif %}">
                            <a href="{{ item.url }}" class="nav-link">
                                <i class="nav-icon fas {{ item.icon }}"></i>
                                <span class="nav-text">{{ item.title }}</span>
                            </a>
                        </li>
                        {% endfor %}
                    {% else %}
                        <li class="nav-item">
                            <span class="nav-link">No menu items available</span>
                        </li>
                    {% endif %}
                </ul>
            </div>
            {% endfor %}
        {% endif %}
    </div>

    <!-- User Menu (Bottom) -->
    <div class="sidebar-footer">
        <div class="user-menu">
            <!-- Manual Fallback -->
            <a href="#" class="user-menu-item">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
            <a href="#" class="user-menu-item">
                <i class="fas fa-question-circle"></i>
                <span>Help & Support</span>
            </a>
            <a href="/debug" class="user-menu-item">
                <i class="fas fa-bug"></i>
                <span>Debug</span>
            </a>
            
            <!-- Dynamic user menu (original code) -->
            {% if user_menu is defined and user_menu %}
                {% for item in user_menu %}
                <a href="{{ item.url }}" class="user-menu-item" style="display: none;"><!-- Hidden for now -->
                    <i class="fas {{ item.icon }}"></i>
                    <span>{{ item.title }}</span>
                </a>
                {% endfor %}
            {% endif %}
        </div>
    </div>
</div>

<!-- Sidebar Overlay (for mobile) -->
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<!-- Sidebar Toggle JavaScript -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const toggle = document.getElementById('sidebarToggle');
        const sidebar = document.querySelector('.sidebar');
        const overlay = document.getElementById('sidebarOverlay');
        
        function toggleSidebar() {
            sidebar.classList.toggle('collapsed');
            document.body.classList.toggle('sidebar-collapsed');
            
            if (window.innerWidth < 992) {
                overlay.classList.toggle('active');
            }
        }
        
        // Toggle sidebar when button is clicked
        toggle.addEventListener('click', toggleSidebar);
        
        // Close sidebar when overlay is clicked (mobile)
        overlay.addEventListener('click', function() {
            sidebar.classList.remove('collapsed');
            document.body.classList.remove('sidebar-collapsed');
            overlay.classList.remove('active');
        });
        
        // Adjust sidebar state on window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth < 992) {
                sidebar.classList.remove('collapsed');
                document.body.classList.remove('sidebar-collapsed');
                overlay.classList.remove('active');
            }
        });
    });
</script>