{% extends "layouts/finchat_dark_layout.html" %}

{% set active_nav = 'debug' %}

{% block header_title %}Settings{% endblock %}

{% block main_content %}
<div class="finchat-card">
    <div class="finchat-card-header">
        <h2>Application Settings</h2>
    </div>
    
    <div class="finchat-card-content">
        <div class="finchat-settings-section">
            <h3>User Interface</h3>
            
            <div class="finchat-settings-group">
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">Theme</div>
                    <div class="finchat-settings-control">
                        <select class="finchat-select" id="themeSelect">
                            <option value="dark" selected>Dark</option>
                            <option value="light">Light</option>
                            <option value="system">System Default</option>
                        </select>
                    </div>
                </div>
                
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">Dashboard Layout</div>
                    <div class="finchat-settings-control">
                        <select class="finchat-select" id="layoutSelect">
                            <option value="grid" selected>Grid</option>
                            <option value="list">List</option>
                        </select>
                    </div>
                </div>
                
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">Sidebar Expanded</div>
                    <div class="finchat-settings-control">
                        <label class="finchat-toggle">
                            <input type="checkbox" id="sidebarToggle" checked>
                            <span class="finchat-toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="finchat-settings-section">
            <h3>Data Settings</h3>
            
            <div class="finchat-settings-group">
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">Data Refresh Interval</div>
                    <div class="finchat-settings-control">
                        <select class="finchat-select" id="refreshSelect">
                            <option value="5">5 minutes</option>
                            <option value="15" selected>15 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="60">1 hour</option>
                        </select>
                    </div>
                </div>
                
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">Cache Expiration</div>
                    <div class="finchat-settings-control">
                        <select class="finchat-select" id="cacheSelect">
                            <option value="300" selected>5 minutes</option>
                            <option value="900">15 minutes</option>
                            <option value="1800">30 minutes</option>
                            <option value="3600">1 hour</option>
                        </select>
                    </div>
                </div>
                
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">Enable Data Export</div>
                    <div class="finchat-settings-control">
                        <label class="finchat-toggle">
                            <input type="checkbox" id="exportToggle" checked>
                            <span class="finchat-toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="finchat-settings-section">
            <h3>API Configuration</h3>
            
            <div class="finchat-settings-group">
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">AI Model</div>
                    <div class="finchat-settings-control">
                        <select class="finchat-select" id="aiModelSelect">
                            <option value="gemini">Google Gemini</option>
                            <option value="openai" selected>OpenAI</option>
                        </select>
                    </div>
                </div>
                
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">API Request Timeout</div>
                    <div class="finchat-settings-control">
                        <select class="finchat-select" id="timeoutSelect">
                            <option value="10">10 seconds</option>
                            <option value="20" selected>20 seconds</option>
                            <option value="30">30 seconds</option>
                            <option value="60">60 seconds</option>
                        </select>
                    </div>
                </div>
                
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">API Endpoint</div>
                    <div class="finchat-settings-control">
                        <input type="text" class="finchat-input" id="apiEndpoint" value="https://api.openai.com/v1">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="finchat-settings-section">
            <h3>Debug Options</h3>
            
            <div class="finchat-settings-group">
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">Enable Debug Logging</div>
                    <div class="finchat-settings-control">
                        <label class="finchat-toggle">
                            <input type="checkbox" id="debugToggle">
                            <span class="finchat-toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">Console Logger</div>
                    <div class="finchat-settings-control">
                        <label class="finchat-toggle">
                            <input type="checkbox" id="consoleToggle" checked>
                            <span class="finchat-toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="finchat-settings-item">
                    <div class="finchat-settings-label">File Logger</div>
                    <div class="finchat-settings-control">
                        <label class="finchat-toggle">
                            <input type="checkbox" id="fileToggle" checked>
                            <span class="finchat-toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="finchat-card-footer">
        <button class="finchat-button" id="resetButton">Reset to Defaults</button>
        <button class="finchat-button-primary" id="saveButton">Save Settings</button>
    </div>
</div>
{% endblock %}

{% block additional_scripts %}
<style>
    /* Settings specific styles */
    .finchat-settings-section {
        margin-bottom: 24px;
    }
    
    .finchat-settings-section h3 {
        font-size: 1rem;
        margin-bottom: 16px;
        padding-bottom: 8px;
        border-bottom: 1px solid var(--fc-border);
    }
    
    .finchat-settings-group {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }
    
    .finchat-settings-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .finchat-settings-label {
        font-size: 0.9rem;
        color: var(--fc-text-secondary);
    }
    
    .finchat-settings-control {
        width: 200px;
    }
    
    /* Form controls */
    .finchat-select {
        width: 100%;
        padding: 8px 12px;
        background-color: var(--fc-bg-tertiary);
        color: var(--fc-text-primary);
        border: 1px solid var(--fc-border);
        border-radius: var(--fc-radius);
        font-size: 0.9rem;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23a0a0a0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 8px center;
        background-size: 16px;
        cursor: pointer;
    }
    
    .finchat-select:focus {
        outline: none;
        border-color: var(--fc-primary);
    }
    
    .finchat-input {
        width: 100%;
        padding: 8px 12px;
        background-color: var(--fc-bg-tertiary);
        color: var(--fc-text-primary);
        border: 1px solid var(--fc-border);
        border-radius: var(--fc-radius);
        font-size: 0.9rem;
    }
    
    .finchat-input:focus {
        outline: none;
        border-color: var(--fc-primary);
    }
    
    /* Toggle switch */
    .finchat-toggle {
        position: relative;
        display: inline-block;
        width: 40px;
        height: 20px;
        cursor: pointer;
    }
    
    .finchat-toggle input {
        opacity: 0;
        width: 0;
        height: 0;
    }
    
    .finchat-toggle-slider {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: var(--fc-bg-tertiary);
        border: 1px solid var(--fc-border);
        border-radius: 20px;
        transition: all 0.3s;
    }
    
    .finchat-toggle-slider:before {
        position: absolute;
        content: "";
        height: 14px;
        width: 14px;
        left: 3px;
        bottom: 2px;
        background-color: var(--fc-text-secondary);
        border-radius: 50%;
        transition: all 0.3s;
    }
    
    .finchat-toggle input:checked + .finchat-toggle-slider {
        background-color: var(--fc-primary-light);
    }
    
    .finchat-toggle input:checked + .finchat-toggle-slider:before {
        background-color: var(--fc-primary);
        transform: translateX(19px);
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Toggle sidebar based on setting
        const sidebarToggle = document.getElementById('sidebarToggle');
        sidebarToggle.addEventListener('change', function() {
            if (!this.checked) {
                document.body.classList.add('sidebar-collapsed');
            } else {
                document.body.classList.remove('sidebar-collapsed');
            }
        });
        
        // Save settings button
        const saveButton = document.getElementById('saveButton');
        saveButton.addEventListener('click', function() {
            // Simulate saving
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
            
            setTimeout(() => {
                this.innerHTML = '<i class="fas fa-check"></i> Saved';
                
                setTimeout(() => {
                    this.innerHTML = 'Save Settings';
                    
                    // Show notification
                    const notification = document.createElement('div');
                    notification.className = 'finchat-notification';
                    notification.innerHTML = `
                        <div class="finchat-notification-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="finchat-notification-content">
                            <h4>Settings Saved</h4>
                            <p>Your settings have been successfully saved.</p>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.classList.add('active');
                        
                        setTimeout(() => {
                            notification.classList.remove('active');
                            setTimeout(() => {
                                notification.remove();
                            }, 300);
                        }, 3000);
                    }, 100);
                    
                }, 1000);
            }, 1000);
        });
        
        // Reset button
        const resetButton = document.getElementById('resetButton');
        resetButton.addEventListener('click', function() {
            if (confirm('Reset all settings to default values?')) {
                // Simulate reset
                this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Resetting...';
                
                setTimeout(() => {
                    // Reset form values
                    document.getElementById('themeSelect').value = 'dark';
                    document.getElementById('layoutSelect').value = 'grid';
                    document.getElementById('sidebarToggle').checked = true;
                    document.getElementById('refreshSelect').value = '15';
                    document.getElementById('cacheSelect').value = '300';
                    document.getElementById('exportToggle').checked = true;
                    document.getElementById('aiModelSelect').value = 'openai';
                    document.getElementById('timeoutSelect').value = '20';
                    document.getElementById('apiEndpoint').value = 'https://api.openai.com/v1';
                    document.getElementById('debugToggle').checked = false;
                    document.getElementById('consoleToggle').checked = true;
                    document.getElementById('fileToggle').checked = true;
                    
                    // Ensure sidebar expanded
                    document.body.classList.remove('sidebar-collapsed');
                    
                    this.innerHTML = 'Reset to Defaults';
                }, 1000);
            }
        });
        
        // Add notification style
        const styleElement = document.createElement('style');
        styleElement.textContent = `
            .finchat-notification {
                position: fixed;
                bottom: 24px;
                right: 24px;
                padding: 16px;
                background-color: var(--fc-bg-tertiary);
                border-left: 4px solid var(--fc-primary);
                border-radius: var(--fc-radius);
                box-shadow: var(--fc-shadow);
                display: flex;
                align-items: flex-start;
                gap: 16px;
                z-index: 1000;
                max-width: 300px;
                transform: translateX(120%);
                transition: transform 0.3s;
            }
            
            .finchat-notification.active {
                transform: translateX(0);
            }
            
            .finchat-notification-icon {
                font-size: 1.2rem;
                color: var(--fc-primary);
            }
            
            .finchat-notification-content h4 {
                margin: 0 0 4px 0;
                font-size: 0.9rem;
                font-weight: 600;
            }
            
            .finchat-notification-content p {
                margin: 0;
                font-size: 0.8rem;
                color: var(--fc-text-secondary);
            }
        `;
        document.head.appendChild(styleElement);
    });
</script>
{% endblock %}